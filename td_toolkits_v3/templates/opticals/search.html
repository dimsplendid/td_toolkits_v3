{% extends "base.html" %}
{% block title %}
Optical Search
{% endblock title %}
{% block content %}
<h2>Optical Search</h2>
<h3>Select <a href="{% url 'materials:lc_list' %}">LCs</a></h3>
<div>
<form action='' method='GET'>
    <select class='form-select' multiple name='q'>
        {% for lc in lc_list %}
        <option> {{ lc }}</option>
        {% endfor %}
    </select>
    <h3><a href="{% url 'opticals:search_profile_list' %}">Search Profile</a></h3>
    <select class='form-select' name='profile'>
        {% for profile_name in profile_list %}
        <option 
        {% if request.GET.profile == profile_name %}
        selected
        {% endif %}>
            {{ profile_name }}
        </option>
        {% endfor %}
    </select>
    <button class='btn btn-primary' type='submit'>Change</button>
    <a href="{% url 'opticals:search_profile_update' profile.slug %}?next={{request.path}}"
        class='btn btn-info'
    >
        Update
    </a>
    <div class='table'>
        {{ profile_table|safe }}
    </div>
    <button class='btn btn-primary' type='submit'>Search</button>
</form>

{% if q %}
<hr>
<h3>LC Cell Gap Setting</h3>
<table class='table text-center small table-hover'>
    <thead>
        <th>LC</th>
        <th>Designed Cell Gap</th>
        <th>Change</th>
    </thead>
    <tbody>
        {% for lc in q_lc_list  %}
        <tr>
            <td>
                {{ lc.name }}
            </td>
            <td>
                {{ lc.designed_cell_gap }}
            </td>
            <td>
                <form action="{% url 'materials:lc_update' slug=lc.slug %}" method='GET'>
                    <input type="hidden" name="next" value="{{ request.get_full_path }}">
                    <button type='submit' class='btn btn-info'>
                    </button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<hr>
<h2>Result</h2>
<div>
    <h3>Figure 1: Opt Score Histagram</h3>
    {{ opt_plot|safe }}
</div>
<div>
    <h3>Table 1: Opt Score</h3>
    {{ opt_score|safe }}
</div>
<div>
    <h3>Table 2: Opt Score Raw</h3>
    {{ opt_score_raw|safe }}
</div>
<a class='btn btn-primary' href="{% url 'opticals:search_download' %}">
    Download
</a>
<a class='btn btn-primary' href="">
    Next
</a>
{% endif %}
</div>
{% endblock content %}